---
layout: default
---

{% if page.header.overlay_color or page.header.overlay_image or page.header.image %}
  {% include page__hero.html %}
{% endif %}

{% if page.url != "/" and site.breadcrumbs %}
  {% unless paginator %}
    {% include breadcrumbs.html %}
  {% endunless %}
{% endif %}

<div id="main" role="main">
  {% include sidebar.html %}

  <div class="archive">
    {% unless page.header.overlay_color or page.header.overlay_image %}
      <h1 class="page__title">{{ page.title }}</h1>
      <div>
        <div>
          <strong>Filter by Type</strong>
          <div class="filter-container">
            <div class="filter-dropdown">
              <button onclick="toggleFilterDropdown()">Filter by Publication Type</button>
              <div id="filter-options" class="filter-options">
                <label>
                  <input type="checkbox" value="select-all" id="select-all"> Select All
                </label>
                {% assign collection_posts = site.publications %}
                {% assign all_tags = "" %}
                {% for post in collection_posts %}
                  {% assign post_tags = post.tags | join: ',' | append: ',' %}
                  {% assign all_tags = all_tags | append: post_tags %}
                {% endfor %}
                {% assign unique_tags = all_tags | split: ',' | uniq %}
                {% for tag in unique_tags %}
                  <label>
                    <input type="checkbox" value="{{ tag }}" class="tag-checkbox"> {{ tag }}
                  </label>
                {% endfor %}
                <button onclick="applyFilter()">Done</button>
              </div>
            </div>
          </div>
        </div>
        <div>
          <strong>Sort by:</strong>
          <select id="sort-selector" class="sort-selector">
            <option value="new-to-old">Newest to Oldest</option>
            <option value="old-to-new">Oldest to Newest</option>
          </select>
        </div>
      </div>
      <div id="posts-container">
        {% for post in site.publications reversed %}
            <div class="post" data-date="{{ post.date | date: '%s' }}" data-tags="{{ post.tags | join: ',' }}">
                {% include archive-single.html %}
            </div>
        {% endfor %}
      </div>
    {% endunless %}
  </div>
</div>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Function to sort posts by date
        function sortPostsByDate(option) {
            const postsContainer = document.getElementById('posts-container');
            const posts = Array.from(postsContainer.children);
            
            posts.sort(function (a, b) {
                const dateA = parseInt(a.getAttribute('data-date'));
                const dateB = parseInt(b.getAttribute('data-date'));
                
                if (option === 'new-to-old') {
                    return dateB - dateA;
                } else if (option === 'old-to-new') {
                    return dateA - dateB;
                }
                
                // Add more sorting options as needed
                
                return 0;
            });
            
            posts.forEach(post => {
                postsContainer.appendChild(post);
            });
        }

        // Event listener for tag filter
        // const tagButtons = document.querySelectorAll('.tag-button');
        // tagButtons.forEach(button => {
        //     button.addEventListener('click', function () {
        //         const selectedTag = this.getAttribute('data-tag');
        //         filterPostsByTag(selectedTag);
        //     });
        // });
        
        // Event listener for tag filter (attempt 2)


        // Event listener for date sorting
        const sortSelector = document.getElementById('sort-selector');
        sortSelector.addEventListener('change', function () {
            const selectedOption = sortSelector.value;
            sortPostsByDate(selectedOption);
        });

        });
function toggleFilterDropdown() {
  const filterOptions = document.getElementById('filter-options');
  filterOptions.style.display = (filterOptions.style.display === 'block') ? 'none' : 'block';
}

// Function to filter posts by selected tags
function filterPostsByTag(tag) {
  const selectedTags = document.querySelector('.select-field')
  const posts = Array.from(document.querySelectorAll('.post'));
  
  posts.forEach(post => {
    const postTags = post.getAttribute('data-tags').split(',');
    if (selectedTags.length === 0 || selectedTags.some(tag => postTags.includes(tag))) {
      post.style.display = 'block';
    } else {
      post.style.display = 'none';
    }
  });
}

// Get all checkboxes and the "Select All" checkbox
const checkboxes = document.querySelectorAll('.tag-checkbox');
const selectAllCheckbox = document.getElementById('select-all');

// Add a change event listener to the "Select All" checkbox
selectAllCheckbox.addEventListener('change', function () {
  // Set all individual tag checkboxes to the state of "Select All" checkbox
  checkboxes.forEach(checkbox => {
    checkbox.checked = selectAllCheckbox.checked;
  });
  selectAllCheckbox.value = selectAllCheckbox.checked ? 'Deselect All' : 'Select All';
});



function applyFilter() {
  // Update the post display based on the selected tags
  const allPosts = document.querySelectorAll('.post');
  const selectedTags = Array.from(checkboxes)
  .filter(checkbox => checkbox.checked)
  .map(checkbox => checkbox.value);

  allPosts.forEach(post => {
    const postTags = post.getAttribute('data-tags').split(',');

    if (selectedTags.length === 0 || selectedTags.some(tag => postTags.includes(tag))) {
      post.style.display = 'block';
    } else {
      post.style.display = 'none';
    }
  });


  toggleFilterDropdown();
}
</script>